package everis.beca.java.practicas.mavenPrueba;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;

import everis.beca.java.practicas.mavenPrueba.dto.BbDd;

public class ConnectionDatabase {


	public static void main(String[] args) {
		
	
		try {
			BbDd BbDd = new BbDd();
			Connection conn = BbDd.getConnection();
			Statement st = conn.createStatement();
			//String queryInsert = "insert into alumno (nombre, apellidos, email, ciudad, id_alumno) values ('Roberto Carlos', 'Quesada Orts', 'robertocqo@gmail.com', 'Alicante', 1)";
			//st.executeUpdate(queryInsert);
			ResultSet rs = null;
			ResultSet rs2 = null;
			ResultSet rs3 = null;
			String querySelect = "Select * from alumno";
			String querySelect2 = "Select alumno.nombre, alumno.email FROM alumno WHERE nombre LIKE '%S%'";
			String querySelect3 = "Select alumno.apellidos, alumno.nombre, clase.nombre FROM alumno, clase INNER JOIN id WHERE apellidos LIKE '%A%'";
			st = conn.createStatement();
//			rs = st.executeQuery(querySelect);
//			rs2 = st.executeQuery(querySelect2);
			rs3 = st.executeQuery(querySelect3);
			System.out.println("------------------------------------------------------------");
			System.out.println("------------------------------------------------------------");
			System.out.println("PINTAR POR CONSOLA TODOS LOS DATOS DE LOS ALUMNOS DE LA BBDD");
			System.out.println("------------------------------------------------------------");
			System.out.println("------------------------------------------------------------");
/*			while (rs.next()) {
				String id = rs.getString(1);
				String nombre = rs.getString(1);
				String apellidos = rs.getString(3);
				String email = rs.getString(4);
				String ciudad = rs.getString(5);
				System.out.println(id + " " + nombre + " " + apellidos+ " " + ciudad + " " + email);
			}
			rs.close();
			
			while (rs2.next()) {
				String nom2 = rs2.getString(1);
				String em2 = rs2.getString(2);
				System.out.println(nom2 + " " + em2);
			}
			rs2.close();
*/			while (rs3.next()) {
				String nom3 = rs3.getString(2);
				String curso = rs3.getString(3);
				System.out.println(nom3 + " " + curso);
			}
			rs3.close();
			st.close();
			
			conn.close();
		} catch (Exception e) {
			System.out.println(e.toString());
		}

	}
}